Dakota
========

.. sidebar:: Dakota

   :Version: 6.14.0
   :Dependencies: https://dakota.sandia.gov/content/install-required-tools-and-libraries
   :URL: https://dakota.sandia.gov/
   :Documentation: https://dakota.sandia.gov/quickstart.html

Dakota is a general-purpose software toolkit for 
performing systems analysis and design on high performance computers. 
Dakota provides algorithms for design optimization, uncertainty quantification, 
parameter estimation, design of experiments, and sensitivity analysis, as well 
as a range of parallel computing and simulation interfacing services.

-------

General Usage
-------------

Dakota 6.14.0 can be activated using the module file

.. code-block:: bash

    module load apps/dakota/6.14.0/gcc-8.2-cmake-3.17.1


.. hint::

    * It is recommended that users submit each Dakota subtask to the scheduler: ``simulator_script.sh`` 
      should submit numerous SGE jobs.
    * `Bash Heredoc scripting <https://linuxize.com/post/bash-heredoc/>`_ may be useful 
      or required as part of submitting Dakota subtasks to the scheduler engine with 
      ``simulator_script.sh`` to adjust resource requests or sub-script variables.

-------

Interactive Usage
-----------------
Dakota can be used on the command line with a IDE style GUI editor also available.
To do so start a X11 GUI forwarding supported SSH session then start an interactive session 
with the ``qrshx`` command (which supports graphical applications).

The Dakota module can be loaded and used as below:

.. code-block:: bash

    # Load Dakota Module 
    module load apps/dakota/6.14.0/gcc-8.2-cmake-3.17.1
    # Show Dakota version
    dakota --v 
    # Copy example
    cp /usr/local/packages/apps/dakota/6.14.0/gcc-8.2-cmake-3.17.1/share/dakota/examples/users/rosen_multidim.in ./
    # Run example
    dakota -i rosen_multidim.in -o rosen_multidim.out 
    # Or optionally start  and use the Dakota GUI
    DakotaUI   

-------

Batch Usage
------------

.. caution::

    * Use of the ``#$ -V`` SGE option will instruct SGE to import your current terminal environment variables to be imported - **CAUTION** - this may not be desirable as it could cause conflicts between modules.


.. code-block:: bash

    #!/bin/bash
    #$ -cwd
    #$ -V 
    #$ -M a.person@sheffield.ac.uk
    #$ -m abe
    #$ -l h_rt=00:10:00
    #$ -l rmem=2G
    #$ -pe smp 1
    #$ -N DakotaExample
    
    # Load Dakota Module 
    module load apps/dakota/6.14.0/gcc-8.2-cmake-3.17.1
    # Copy example
    cp /usr/local/packages/apps/dakota/6.14.0/gcc-8.2-cmake-3.17.1/share/dakota/examples/users/rosen_multidim.in ./
    # Run example
    dakota -i rosen_multidim.in -o rosen_multidim.out 

Installation notes
------------------

Version 6.14.0
^^^^^^^^^^^^^^

Dakota 6.14.0 was compiled from source using the
:download:`install_dakota.sh </sharc/software/install_scripts/apps/dakota/6.14.0/install_dakota.sh>` script.

The module file is automatically generated by the script but has been edited to provide the required 
environment as detailed here: https://dakota.sandia.gov/content/set-environment-linux-mac-os-x

The Dakota GUI binaries (Linux - 6.14 GUI Only tar.gz) have been added to the module manually by adding 
a ``gui`` subdirectory to the root installation folder with subsequent download and untar of the 
GUI binaries provided at https://dakota.sandia.gov/download.html. An insertion of the appropriate 
``PATH`` prepend for this ``gui`` subdirectory has also been added to the module file.

**Testing**

Both the Dakota CLI and Dakota GUI appear to function correctly under a ``qrshx`` / batch sessions, 
running the ``rosen_multidim.in`` example successfully both in the CLI and GUI but no extensive further 
testing has been undertaken.
